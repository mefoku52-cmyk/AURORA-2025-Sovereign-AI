#!/bin/bash
# üåå AURORA: CLUSTER INITIATOR V1.1 (FIXED - Iba intern√© moduly)
# Spust√≠ relevantn√Ωch Agentov/Modulov len z kƒæ√∫ƒçov√Ωch intern√Ωch adres√°rov.

echo "CLUSTER INITIATOR: Sp√∫≈°≈•am intern√∫ inicializ√°ciu agentov..."

# OBMEDZEN√â ADRES√ÅRE (Odstr√°nen√© Download/ZALOHA kv√¥li chyb√°m s pr√°vami)
SEARCH_PATHS="/data/data/com.termux/files/home/aurora/scripts /data/data/com.termux/files/home/.config/ultra-os"

# Zoznam kƒæ√∫ƒçov√Ωch typov s√∫borov (Agentov/Modulov)
FILE_TYPES="sh py cpp"
AGENT_COUNT=0

call_monolith() {
    local script_name=$1
    local script_path=$2
    COMMAND="exec_script:$script_name $script_path"
    PYTHON_SCRIPT="/data/data/com.termux/files/home/ai_ultron_MONOLITH.py"

    if [ -f "$PYTHON_SCRIPT" ]; then
        # Sp√∫≈°≈•ame Python priamo, aby poslal pr√≠kaz na localhost HUB
        python3 -c "from ai_ultron_MONOLITH import client_send; print(client_send('$COMMAND'))" 2>/dev/null &
        AGENT_COUNT=$((AGENT_COUNT + 1))
        echo "   [AGENT $AGENT_COUNT] -> Spusten√Ω: $script_name"
    fi
}

# Prehƒæadanie kƒæ√∫ƒçov√Ωch ciest
for type in $FILE_TYPES; do
    echo "Hƒæad√°m v≈°etky *.$type moduly..."
    find $SEARCH_PATHS -type f -name "*.$type" -maxdepth 4 2>/dev/null | while read script_path; do
        script_name=$(basename "$script_path")
        
        # Filtrujeme kƒæ√∫ƒçov√© jadr√° (aby sme ich nespustili znova)
        if [[ "$script_name" != "ULTRA-V500-MEGA-LIVE.py" ]] && [[ "$script_name" != "ai_ultron_MONOLITH.py" ]]; then
            call_monolith "$script_name" "$script_path"
        fi
        
    done
done

echo "‚úÖ KLASTER Spusten√Ω: $AGENT_COUNT modulov bolo odoslan√Ωch na spracovanie cez ULTRON HUB (localhost)."
